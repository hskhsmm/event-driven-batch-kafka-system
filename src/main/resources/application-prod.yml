management:
  endpoints:
    web:
      exposure:
        include: health
  endpoint:
    health:
      show-details: never
  health:
    kafka:
      enabled: false   #  Actuator Kafka Health 완전 제거

spring:
  datasource:
    hikari:
      # maximum-pool-size, minimum-idle은 파티션별 프로필(p2, p3 등)에서 설정
      connection-timeout: 20000 # 커넥션 획득 타임아웃 20초
      idle-timeout: 300000      # 유휴 커넥션 유지 시간 5분
      max-lifetime: 1800000     # 커넥션 최대 수명 30분

  jpa:
    hibernate:
      ddl-auto: validate  # 프로덕션에서는 validate 또는 none 권장
    show-sql: false       # 프로덕션에서는 로깅 최소화
    properties:
      hibernate:
        format_sql: false
        default_batch_fetch_size: 100  # N+1 문제 방지

  # Redis 설정 (프로덕션 - AWS ElastiCache)
  data:
    redis:
      host: ${SPRING_DATA_REDIS_HOST}
      port: ${SPRING_DATA_REDIS_PORT:6379}

  kafka:
    bootstrap-servers: ${SPRING_KAFKA_BOOTSTRAP_SERVERS}
    listener:
      auto-startup: true        #  Consumer 기동
    admin:
      auto-create: true         # (있어도 되고 없어도 됨)

  batch:
    job:
      enabled: false             #  Batch 자동 실행 차단

# Kafka 설정 (프로덕션 - 파티션 1개 기준 안정적 설정)
# ⚠️ 프로덕션에서는 실험용 프로필(p2, p3, p5, p10)을 절대 사용하지 마세요!
kafka:
  producer:
    buffer-memory: 134217728    # 128MB
    batch-size: 65536           # 64KB
    linger-ms: 20               # 20ms
    compression-type: none
    max-block-ms: 60000         # 60초

  consumer:
    max-poll-records: 500       # 한 번에 500개씩 처리
    max-poll-interval-ms: 600000  # 10분
    session-timeout-ms: 45000    # 45초

# 테스트 후 재 활성화 예정