# 파티션 3개 실험용 설정
# 사용법: SPRING_PROFILES_ACTIVE=prod,p3

spring:
  kafka:
    listener:
      concurrency: 3  # Consumer 스레드 3개 (파티션 수와 동일)

  datasource:
    hikari:
      maximum-pool-size: 30     # 25 → 30 (Consumer 스레드 3개 + 여유)
      minimum-idle: 15
      connection-timeout: 20000
      idle-timeout: 300000
      max-lifetime: 1800000

# Kafka 설정 (파티션 3개 최적화)
kafka:
  producer:
    buffer-memory: 201326592    # 192MB (128MB × 1.5배)
    batch-size: 65536           # 64KB (유지)
    linger-ms: 15               # 20ms → 15ms (더 빠른 전송)
    compression-type: none
    max-block-ms: 60000

  consumer:
    max-poll-records: 250       # 300 → 250 (스레드당 부하 감소)
    max-poll-interval-ms: 600000  # 10분 (유지)
    session-timeout-ms: 45000    # 45초 (유지)

# 실험 메모
# 파티션: 3개
# Consumer 스레드: 3개 (자동)
# 예상 TPS: 2,000 ~ 2,500
# 예상 CPU: 60~65%
# 순서 보장: 파티션별로만 보장
# 파티션 편향 가능성 있음 (해시 함수 의존)
